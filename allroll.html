{\rtf1\ansi\ansicpg950\cocoartf2822
\cocoatextscaling0\cocoaplatform0{\fonttbl\f0\fswiss\fcharset0 Helvetica;\f1\fnil\fcharset136 PingFangTC-Regular;}
{\colortbl;\red255\green255\blue255;}
{\*\expandedcolortbl;;}
\paperw11900\paperh16840\margl1440\margr1440\vieww12720\viewh7240\viewkind0
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardirnatural\partightenfactor0

\f0\fs24 \cf0 <!DOCTYPE html>\
<html lang="zh-TW">\
<head>\
    <meta charset="UTF-8">\
    <meta name="viewport" content="width=device-width, initial-scale=1.0">\
    <title>
\f1 \'a4\'ac\'b0\'ca\'a6\'a1\'c2\'49\'a6\'57\'aa\'ed
\f0  V5</title>\
    <script src="https://cdn.tailwindcss.com"></script>\
    <style>\
        body \{\
            font-family: 'Microsoft JhengHei', sans-serif; /* Specifies a common Chinese font */\
            background-color: #f0f4f8; /* Light blue-gray background */\
        \}\
        .student-card \{\
            transition: all 0.3s ease; /* Smooth transition for card changes */\
        \}\
        .student-card.absent \{\
            background-color: #fee2e2; /* Light red for absent students */\
            border-color: #ef4444; /* Red border for absent students */\
        \}\
        .student-card.present \{\
            background-color: #dcfce7; /* Light green for present students */\
            border-color: #22c55e; /* Green border for present students */\
        \}\
        .info-text \{\
            font-size: 0.8rem; /* Smaller font size for informational text */\
            color: #4b5563; /* Dark gray text color */\
            margin-top: 0.25rem; /* Small top margin */\
            font-style: italic; /* Italicized text */\
        \}\
    </style>\
    <script>\
        document.addEventListener('DOMContentLoaded', function() \{\
            // Set default date to today\
            const today = new Date().toISOString().split('T')[0];\
            document.getElementById('classDate').value = today;\
\
            // Event listener for the "Generate Attendance Sheet" button\
            document.getElementById('generateBtn').addEventListener('click', function() \{\
                const className = document.getElementById('className').value;\
                const studentCount = parseInt(document.getElementById('studentCount').value);\
                const missingNumbers = document.getElementById('missingNumbers').value.split(',')\
                    .map(num => num.trim()) // Remove whitespace\
                    .filter(num => num !== '') // Remove empty strings\
                    .map(num => parseInt(num)); // Convert to numbers\
\
                // Validate class name\
                if (!className) \{\
                    // Instead of alert, you could use a custom modal or inline message\
                    // For simplicity, alert is used here.\
                    alert('
\f1 \'bd\'d0\'bf\'e9\'a4\'4a\'af\'5a\'af\'c5\'a6\'57\'ba\'d9
\f0 ');\
                    return;\
                \}\
\
                // Validate student count\
                if (isNaN(studentCount) || studentCount <= 0 || studentCount > 100) \{\
                    alert('
\f1 \'bd\'d0\'bf\'e9\'a4\'4a\'a6\'b3\'ae\'c4\'aa\'ba\'be\'c7\'a5\'cd\'a4\'48\'bc\'c6\'a1\'5d
\f0 1-100
\f1 \'a1\'5e
\f0 ');\
                    return;\
                \}\
\
                generateAttendanceCards(studentCount, missingNumbers);\
                updateStatistics();\
            \});\
\
            // Event listeners for filter buttons\
            document.getElementById('showAllBtn').addEventListener('click', function() \{\
                showFilteredStudents('all');\
            \});\
            document.getElementById('showPresentBtn').addEventListener('click', function() \{\
                showFilteredStudents('present');\
            \});\
            document.getElementById('showAbsentBtn').addEventListener('click', function() \{\
                showFilteredStudents('absent');\
            \});\
            document.getElementById('showLateBtn').addEventListener('click', function() \{\
                showFilteredStudents('late');\
            \});\
\
            // Event listener for the "Download CSV" button\
            document.getElementById('downloadCsvBtn').addEventListener('click', function() \{\
                downloadAttendanceCSV();\
            \});\
        \});\
\
        // Function to generate student cards\
        function generateAttendanceCards(count, missingNumbers) \{\
            const container = document.getElementById('studentCards');\
            container.innerHTML = ''; // Clear existing cards\
\
            for (let i = 1; i <= count; i++) \{\
                // Skip missing numbers\
                if (missingNumbers.includes(i)) \{\
                    continue;\
                \}\
\
                const card = document.createElement('div');\
                card.className = 'student-card border-2 rounded-lg p-3 bg-white shadow-sm present'; // Default to present\
                card.dataset.status = 'present'; // Store status in data attribute\
                card.dataset.number = i; // Store student number\
\
                // Card HTML structure\
                card.innerHTML = `\
                    <div class="flex justify-between items-center mb-2">\
                        <span class="font-bold text-lg">$\{i\}
\f1 \'b8\'b9
\f0 </span>\
                        <div class="flex gap-1">\
                            <button class="status-btn present-btn w-6 h-6 rounded-full bg-green-500 border-2 border-green-600" title="
\f1 \'a5\'58\'ae\'75
\f0 "></button>\
                            <button class="status-btn absent-btn w-6 h-6 rounded-full bg-red-500 border-2 border-red-600" title="
\f1 \'af\'ca\'ae\'75
\f0 "></button>\
                        </div>\
                    </div>\
                    <div class="mt-2">\
                        <label class="block text-xs text-gray-600">
\f1 \'bf\'f0\'a8\'ec\'ae\'c9\'b6\'a1
\f0 </label>\
                        <input type="time" class="late-time w-full text-sm p-1 border rounded" disabled>\
                        <div class="flex items-center mt-1">\
                            <input type="checkbox" class="late-checkbox mr-1">\
                            <label class="text-xs">
\f1 \'bf\'f0\'a8\'ec
\f0 </label>\
                        </div>\
                    </div>\
                `;\
                container.appendChild(card);\
\
                // Get interactive elements from the card\
                const presentBtn = card.querySelector('.present-btn');\
                const absentBtn = card.querySelector('.absent-btn');\
                const lateCheckbox = card.querySelector('.late-checkbox');\
                const lateTimeInput = card.querySelector('.late-time');\
\
                // Event listener for present button\
                presentBtn.addEventListener('click', function() \{\
                    card.dataset.status = 'present';\
                    card.className = 'student-card border-2 rounded-lg p-3 shadow-sm present';\
                    lateCheckbox.checked = false;\
                    lateTimeInput.disabled = true;\
                    lateTimeInput.value = ''; // Clear late time\
                    updateStatistics();\
                \});\
\
                // Event listener for absent button\
                absentBtn.addEventListener('click', function() \{\
                    card.dataset.status = 'absent';\
                    card.className = 'student-card border-2 rounded-lg p-3 shadow-sm absent';\
                    lateCheckbox.checked = false;\
                    lateTimeInput.disabled = true;\
                    lateTimeInput.value = ''; // Clear late time\
                    updateStatistics();\
                \});\
\
                // Event listener for late checkbox\
                lateCheckbox.addEventListener('change', function() \{\
                    if (this.checked) \{\
                        card.dataset.status = 'late';\
                        card.className = 'student-card border-2 rounded-lg p-3 shadow-sm bg-yellow-100 border-yellow-400'; // Yellow for late\
                        lateTimeInput.disabled = false;\
                    \} else \{\
                        card.dataset.status = 'present'; // Revert to present if unchecked\
                        card.className = 'student-card border-2 rounded-lg p-3 shadow-sm present';\
                        lateTimeInput.disabled = true;\
                        lateTimeInput.value = '';\
                    \}\
                    updateStatistics();\
                \});\
            \}\
        \}\
\
        // Function to update attendance statistics\
        function updateStatistics() \{\
            const cards = document.querySelectorAll('.student-card');\
            let total = cards.length;\
            let present = 0;\
            let absent = 0;\
            let late = 0;\
\
            cards.forEach(card => \{\
                const status = card.dataset.status;\
                if (status === 'present') present++;\
                else if (status === 'absent') absent++;\
                else if (status === 'late') late++;\
            \});\
\
            document.getElementById('totalCount').textContent = total;\
            document.getElementById('presentCount').textContent = present;\
            document.getElementById('absentCount').textContent = absent;\
            document.getElementById('lateCount').textContent = late;\
        \}\
\
        // Function to filter students based on status\
        function showFilteredStudents(filter) \{\
            const cards = document.querySelectorAll('.student-card');\
            cards.forEach(card => \{\
                const status = card.dataset.status;\
                if (filter === 'all') \{\
                    card.style.display = 'block'; // Show all cards\
                \} else \{\
                    card.style.display = (status === filter) ? 'block' : 'none'; // Show/hide based on filter\
                \}\
            \});\
        \}\
\
        // Function to download attendance data as CSV\
        function downloadAttendanceCSV() \{\
            const className = document.getElementById('className').value || '
\f1 \'a5\'bc\'a9\'52\'a6\'57\'af\'5a\'af\'c5
\f0 ';\
            const classDate = document.getElementById('classDate').value || new Date().toISOString().split('T')[0];\
            const classSession = document.getElementById('classSession').value;\
\
            const cards = document.querySelectorAll('.student-card');\
            if (cards.length === 0) \{\
                alert('
\f1 \'bd\'d0\'a5\'fd\'a5\'cd\'a6\'a8\'c2\'49\'a6\'57\'aa\'ed
\f0 ');\
                return;\
            \}\
\
            // CSV header\
            let csvContent = '
\f1 \'ae\'79\'b8\'b9
\f0 ,
\f1 \'a5\'58\'ae\'75
\f0 ,
\f1 \'af\'ca\'ae\'75
\f0 ,
\f1 \'bf\'f0\'a8\'ec
\f0 ,
\f1 \'bf\'f0\'a8\'ec\'ae\'c9\'b6\'a1
\f0 \\n';\
\
            // Add student data to CSV\
            cards.forEach(card => \{\
                const seatNumber = card.dataset.number;\
                const status = card.dataset.status;\
                const lateTime = card.querySelector('.late-time').value || '';\
\
                const isPresent = status === 'present' ? 'O' : '';\
                const isAbsent = status === 'absent' ? 'X' : '';\
                const isLate = status === 'late' ? 'V' : '';\
\
                csvContent += `$\{seatNumber\},$\{isPresent\},$\{isAbsent\},$\{isLate\},$\{lateTime\}\\n`;\
            \});\
\
            // Add statistics to CSV\
            const totalCount = document.getElementById('totalCount').textContent;\
            const presentCount = document.getElementById('presentCount').textContent;\
            const absentCount = document.getElementById('absentCount').textContent;\
            const lateCount = document.getElementById('lateCount').textContent;\
\
            csvContent += '\\n
\f1 \'b2\'ce\'ad\'70\'b8\'ea\'b0\'54
\f0 \\n';\
            csvContent += `
\f1 \'af\'5a\'af\'c5
\f0 ,$\{className\}\\n`;\
            csvContent += `
\f1 \'a4\'e9\'b4\'c1
\f0 ,$\{classDate\}\\n`;\
            csvContent += `
\f1 \'b8\'60\'a6\'b8
\f0 ,
\f1 \'b2\'c4
\f0 $\{classSession\}
\f1 \'b8\'60
\f0 \\n`;\
            csvContent += `
\f1 \'c1\'60\'a4\'48\'bc\'c6
\f0 ,$\{totalCount\}\\n`;\
            csvContent += `
\f1 \'a5\'58\'ae\'75\'a4\'48\'bc\'c6
\f0 ,$\{presentCount\}\\n`;\
            csvContent += `
\f1 \'af\'ca\'ae\'75\'a4\'48\'bc\'c6
\f0 ,$\{absentCount\}\\n`;\
            csvContent += `
\f1 \'bf\'f0\'a8\'ec\'a4\'48\'bc\'c6
\f0 ,$\{lateCount\}\\n`;\
\
            // Create and download CSV file\
            const blob = new Blob(["\\uFEFF" + csvContent], \{ type: 'text/csv;charset=utf-8;' \}); // Add BOM for Excel compatibility\
            const url = URL.createObjectURL(blob);\
            const link = document.createElement('a');\
            link.setAttribute('href', url);\
            link.setAttribute('download', `$\{className\}_
\f1 \'c2\'49\'a6\'57\'aa\'ed
\f0 _$\{classDate\}_
\f1 \'b2\'c4
\f0 $\{classSession\}
\f1 \'b8\'60
\f0 .csv`);\
            link.style.display = 'none';\
            document.body.appendChild(link);\
            link.click();\
            document.body.removeChild(link);\
        \}\
    </script>\
</head>\
<body class="p-4">\
    <div class="max-w-6xl mx-auto bg-white rounded-lg shadow-lg p-6">\
        <h1 class="text-3xl font-bold text-center text-indigo-700 mb-2">Gloira
\f1 \'a6\'d1\'ae\'76\'af\'5a\'af\'c5\'a4\'ac\'b0\'ca\'c2\'49\'a6\'57\'aa\'ed
\f0 </h1>\
        <h2 class="text-xl font-semibold text-center text-white bg-purple-600 p-2 rounded-md mb-6">\
            
\f1 \'b1\'d0\'ae\'76\'a1\'47
\f0 Gloria
\f1 \'a7\'64\'a8\'71\'c4\'f5\'a6\'d1\'ae\'76
\f0 , Google
\f1 \'bb\'7b\'c3\'d2\'c1\'bf\'ae\'76
\f0 , 
\f1 \'ad\'5e\'a4\'e5\'ad\'dd\'a5\'78\'bb\'79\'b1\'d0\'ae\'76
\f0 \
        </h2>\
\
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">\
            <div class="p-4 bg-indigo-50 rounded-lg">\
                <div class="mb-4">\
                    <label for="className" class="block text-sm font-medium text-gray-700 mb-1">
\f1 \'af\'5a\'af\'c5\'a6\'57\'ba\'d9
\f0 </label>\
                    <input type="text" id="className" class="w-full p-2 border rounded-md focus:ring-indigo-500 focus:border-indigo-500" placeholder="
\f1 \'bd\'d0\'bf\'e9\'a4\'4a\'af\'5a\'af\'c5\'a6\'57\'ba\'d9
\f0 ">\
                </div>\
                <div class="mb-4">\
                    <label for="studentCount" class="block text-sm font-medium text-gray-700 mb-1">
\f1 \'be\'c7\'a5\'cd\'a4\'48\'bc\'c6
\f0 </label>\
                    <input type="number" id="studentCount" min="1" max="100" class="w-full p-2 border rounded-md focus:ring-indigo-500 focus:border-indigo-500" placeholder="
\f1 \'bd\'d0\'bf\'e9\'a4\'4a\'a4\'48\'bc\'c6
\f0 ">\
                    <p class="info-text bg-yellow-50 p-2 rounded mt-1 border border-yellow-200">\
                        <svg class="w-4 h-4 inline-block mr-1 text-yellow-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">\
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>\
                        </svg>\
                        
\f1 \'bd\'d0\'bf\'e9\'a4\'4a\'af\'5a\'af\'c5\'a4\'a4\'b3\'cc\'a4\'6a\'aa\'ba\'ae\'79\'b8\'b9\'a1\'5d\'ad\'59\'a6\'b3\'af\'ca\'b8\'b9\'a1\'41\'a4\'b4\'bb\'dd\'bf\'e9\'a4\'4a\'b3\'cc\'ab\'e1\'a4\'40\'ad\'d3\'b8\'b9\'bd\'58\'a1\'5e
\f0 \
                    </p>\
                </div>\
                <div class="mb-4">\
                    <label for="missingNumbers" class="block text-sm font-medium text-gray-700 mb-1">
\f1 \'af\'ca\'b8\'b9\'ae\'79\'b8\'b9
\f0  (
\f1 \'a5\'ce\'b3\'72\'b8\'b9\'a4\'c0\'b9\'6a
\f0 )</label>\
                    <input type="text" id="missingNumbers" class="w-full p-2 border rounded-md focus:ring-indigo-500 focus:border-indigo-500" placeholder="
\f1 \'a8\'d2\'a6\'70
\f0 : 3,7,15">\
                    <p class="info-text">
\f1 \'bf\'e9\'a4\'4a\'a4\'a3\'a6\'73\'a6\'62\'aa\'ba\'ae\'79\'b8\'b9\'a1\'41\'a8\'74\'b2\'ce\'b1\'4e\'a6\'db\'b0\'ca\'b8\'f5\'b9\'4c\'b3\'6f\'a8\'c7\'b8\'b9\'bd\'58
\f0 </p>\
                </div>\
                <button id="generateBtn" class="mt-3 bg-indigo-600 text-white px-4 py-2 rounded-md hover:bg-indigo-700 w-full transition-colors duration-150">
\f1 \'a5\'cd\'a6\'a8\'c2\'49\'a6\'57\'aa\'ed
\f0 </button>\
            </div>\
\
            <div class="p-4 bg-indigo-50 rounded-lg">\
                <div class="mb-4">\
                    <label for="classDate" class="block text-sm font-medium text-gray-700 mb-1">
\f1 \'a4\'e9\'b4\'c1
\f0 </label>\
                    <input type="date" id="classDate" class="w-full p-2 border rounded-md focus:ring-indigo-500 focus:border-indigo-500">\
                </div>\
                <div class="mb-4">\
                    <label for="classSession" class="block text-sm font-medium text-gray-700 mb-1">
\f1 \'a4\'57\'bd\'d2\'b8\'60\'a6\'b8
\f0 </label>\
                    <select id="classSession" class="w-full p-2 border rounded-md focus:ring-indigo-500 focus:border-indigo-500">\
                        <option value="1">
\f1 \'b2\'c4
\f0 1
\f1 \'b8\'60
\f0 </option>\
                        <option value="2">
\f1 \'b2\'c4
\f0 2
\f1 \'b8\'60
\f0 </option>\
                        <option value="3">
\f1 \'b2\'c4
\f0 3
\f1 \'b8\'60
\f0 </option>\
                        <option value="4">
\f1 \'b2\'c4
\f0 4
\f1 \'b8\'60
\f0 </option>\
                        <option value="5">
\f1 \'b2\'c4
\f0 5
\f1 \'b8\'60
\f0 </option>\
                        <option value="6">
\f1 \'b2\'c4
\f0 6
\f1 \'b8\'60
\f0 </option>\
                        <option value="7">
\f1 \'b2\'c4
\f0 7
\f1 \'b8\'60
\f0 </option>\
                        <option value="8">
\f1 \'b2\'c4
\f0 8
\f1 \'b8\'60
\f0 </option>\
                    </select>\
                </div>\
                <div class="flex justify-end mt-6">\
                    <button id="downloadCsvBtn" class="bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 transition-colors duration-150 flex items-center">\
                        <svg class="w-4 h-4 inline-block mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">\
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path>\
                        </svg>\
                        
\f1 \'a4\'55\'b8\'fc
\f0 CSV\
                    </button>\
                </div>\
            </div>\
        </div>\
\
        <div class="flex flex-wrap gap-2 mb-4">\
            <button id="showAllBtn" class="bg-gray-600 text-white px-4 py-2 rounded-md hover:bg-gray-700 transition-colors duration-150">
\f1 \'c5\'e3\'a5\'dc\'a5\'fe\'b3\'a1
\f0 </button>\
            <button id="showPresentBtn" class="bg-green-600 text-white px-4 py-2 rounded-md hover:bg-green-700 transition-colors duration-150">
\f1 \'b6\'c8\'c5\'e3\'a5\'dc\'a5\'58\'ae\'75
\f0 </button>\
            <button id="showAbsentBtn" class="bg-red-600 text-white px-4 py-2 rounded-md hover:bg-red-700 transition-colors duration-150">
\f1 \'b6\'c8\'c5\'e3\'a5\'dc\'af\'ca\'ae\'75
\f0 </button>\
            <button id="showLateBtn" class="bg-yellow-500 text-white px-4 py-2 rounded-md hover:bg-yellow-600 transition-colors duration-150">
\f1 \'b6\'c8\'c5\'e3\'a5\'dc\'bf\'f0\'a8\'ec
\f0 </button>\
        </div>\
\
        <div class="bg-blue-50 p-4 rounded-lg mb-6">\
            <h2 class="text-lg font-semibold mb-2 text-blue-800">
\f1 \'a5\'58\'ae\'75\'b2\'ce\'ad\'70
\f0 </h2>\
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4 text-center">\
                <div class="bg-white p-3 rounded-md shadow">\
                    <div class="text-sm text-gray-600">
\f1 \'c1\'60\'a4\'48\'bc\'c6
\f0 </div>\
                    <div id="totalCount" class="text-2xl font-bold text-blue-700">0</div>\
                </div>\
                <div class="bg-white p-3 rounded-md shadow">\
                    <div class="text-sm text-gray-600">
\f1 \'a5\'58\'ae\'75\'a4\'48\'bc\'c6
\f0 </div>\
                    <div id="presentCount" class="text-2xl font-bold text-green-700">0</div>\
                </div>\
                <div class="bg-white p-3 rounded-md shadow">\
                    <div class="text-sm text-gray-600">
\f1 \'af\'ca\'ae\'75\'a4\'48\'bc\'c6
\f0 </div>\
                    <div id="absentCount" class="text-2xl font-bold text-red-700">0</div>\
                </div>\
                <div class="bg-white p-3 rounded-md shadow">\
                    <div class="text-sm text-gray-600">
\f1 \'bf\'f0\'a8\'ec\'a4\'48\'bc\'c6
\f0 </div>\
                    <div id="lateCount" class="text-2xl font-bold text-yellow-600">0</div>\
                </div>\
            </div>\
        </div>\
\
        <div id="studentCards" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4">\
            </div>\
    </div>\
</body>\
</html>\
}